var FormStatus={config:{},formComponentsQuery:"",datalessFormComponentsQuery:"",scrollableComponentsQuery:"",disabledClass:"",processingClass:"",element:null,formComponents:null,datalessFormComponents:null,scrollableComponents:null,activeButton:null,formComponentCount:0,datalessFormComponentCount:0,scrollableComponentCount:0,removeClassSearch:null,create:function(){var t=Object.create(this);return t._construct.apply(t,arguments),t},_construct:function(t){t="undefined"==typeof t?{}:t,this.config.formComponentsQuery=t.formComponentsQuery||"a.btn, button, div.select-box, input, span.input-checkbox, select, submit, textarea",this.config.datalessFormComponentsQuery=t.datalessFormComponentsQuery||"button, submit",this.config.scrollableComponentsQuery=t.scrollableComponentsQuery||".legal-agreement",this.config.disabledClass=t.disabledClass||"disabled",this.config.processingClass=t.processingClass||"processing",this.setup()},setup:function(){this.formComponentsQuery=this.config.formComponentsQuery,this.datalessFormComponentsQuery=this.config.datalessFormComponentsQuery,this.scrollableComponentsQuery=this.config.scrollableComponentsQuery,this.formComponents=document.querySelectorAll(this.formComponentsQuery),this.datalessFormComponents=document.querySelectorAll(this.datalessFormComponentsQuery),this.scrollableComponents=document.querySelectorAll(this.scrollableComponentsQuery),this.formComponentCount=this.formComponents.length,this.datalessFormComponentCount=this.datalessFormComponents.length,this.scrollableComponentCount=this.scrollableComponents.length,this.disabledClass=this.config.disabledClass,this.processingClass=this.config.processingClass,this.removeClassSearch=new RegExp("\\b"+this.disabledClass+"|"+this.processingClass+"\\b","g")},toggle:function(t,e,i){t?(this._enableFields(),this._toggleScrolling(!0)):(i=i||!1,this.activeButton=e||null,this._disableFields(i),this._toggleScrolling(!1))},_enableFields:function(){for(var t=0;t<this.formComponentCount;t++)this.element=this.formComponents[t],this.element.className=this.element.className.replace(this.removeClassSearch,""),this.element.disabled=!1},_disableFields:function(t){for(var e=0;e<this.formComponentCount;e++)this.element=this.formComponents[e],this.element.className+=" "+this.disabledClass,t&&(this.element.disabled=!0);if(!t)for(var e=0;e<this.datalessFormComponentCount;e++)this.element=this.datalessFormComponents[e],this.element.disabled=!0;this.activeButton&&(this.activeButton.className+=" "+this.processingClass)},_toggleScrolling:function(t){for(var e=0;e<this.scrollableComponentCount;e++)this.element=this.scrollableComponents[e],this.element.style.overflowY=t?"auto":"hidden"}},Country={config:{},formQuery:"",inputCountryQuery:"",inputCountryPresentationQuery:"",currentCountryPresentationQuery:"",selectedCountryPresentationClass:"",$form:null,$inputCountry:null,$inputCountryPresentation:null,$dialogue:null,defaultCountry:"",oldCountry:"",newCountry:"",placeholder:!1,create:function(){var t=Object.create(this);return t._construct.apply(t,arguments),t},_construct:function(t){t="undefined"==typeof t?{}:t,this.config=$.extend({formQuery:t.formQuery||"#change-country",inputCountryQuery:t.inputCountryQuery||"#country-list",inputHiddenCountryQuery:t.inputHiddenCountryQuery||"#hidden-country",minInputCountriesQuery:t.minInputCountriesQuery||"#change-country .dropdown-menu a",inputCountryPresentationQuery:t.countryPresentationQuery||"#select-box-country-list",currentCountryPresentationQuery:t.currentCountryPresentationQuery||".current .text",selectedCountryPresentationClass:t.selectedCountryPresentationClass||"selected",defaultCountry:t.defaultCountry||"",placeholder:t.placeholder||!1},t),this.setup()},setup:function(){this.$form=$(this.config.formQuery),this.$inputCountry=$(this.config.inputCountryQuery),this.$inputHiddenCountry=$(this.config.inputHiddenCountryQuery),this.$minInputCountries=$(this.config.minInputCountriesQuery),this.oldCountry=this.$inputCountry.val(),this.inputCountryPresentationQuery=this.config.inputCountryPresentationQuery,this.currentCountryPresentationQuery=this.config.currentCountryPresentationQuery,this.selectedCountryPresentationClass=this.config.selectedCountryPresentationClass,this.defaultCountry=this.config.defaultCountry,this.placeholder=this.config.placeholder,this.reset(),this.registerEvents()},reset:function(){(this.defaultCountry||this.placeholder)&&this.$inputCountry.val(this.defaultCountry)},registerEvents:function(){this.$inputCountry.on("change",$.proxy(this.submit,this)),this.$minInputCountries.on("click",$.proxy(this.submit,this))},submit:function(t){var e=this.$inputCountry.val()||$(t.target).data("alpha3");e!=this.oldCountry&&(this.newCountry=e,this.$inputHiddenCountry.val(e),this.$form.submit())}},Email={emailPattern:null,create:function(){var t=Object.create(this);return t._construct.apply(t,arguments),t},_construct:function(t){t="undefined"==typeof t?{}:t,this.emailPattern=t.emailPattern||new RegExp("^[0-9a-zA-Z+_.-]{1,64}@[0-9a-zA-Z_-]+\\.[0-9a-zA-Z_.-]+$")},check:function(t){return this.emailPattern.test(t)}},Creation={config:{},containerQuery:"",formQuery:"",visibleFormComponentsQuery:"",unrestrictedInputFieldsQuery:"",inputParentsQuery:"",inputHelpQuery:"",selectsRequiredQuery:"",inputsRequiredQuery:"",inputNidQuery:"",inputEmailQuery:"",inputEmailConfirmationQuery:"",inputPasswordQuery:"",inputPasswordConfirmationQuery:"",passwordRatingQuery:"",inputAgeQuery:"",inputDobDayQuery:"",inputDobMonthQuery:"",inputDobYearQuery:"",inputParentEmailQuery:"",containerCaptchaQuery:"",imageCaptchaQuery:"",iconCaptchaReloadQuery:"",buttonSubmitQuery:"",buttonCancelQuery:"",errorContainerTemplateQuery:"",alertContainerQuery:"",promoVideo:"",inputSmsCountryCodeQuery:"",inputSmsMobileNumberQuery:"",inputSmsVerificationCodeQuery:"",sendSmsVerificationButtonQuery:"",errorClass:"",loadingClass:"",$container:null,$form:null,$visibleFormComponents:null,$unrestrictedInputFields:null,$selectsRequired:null,$inputsRequired:null,$inputNid:null,$inputEmail:null,$inputEmailConfirmation:null,$inputPassword:null,$inputPasswordConfirmation:null,$passwordRating:null,$inputAge:null,$inputDobDay:null,$inputDobMonth:null,$inputDobYear:null,$inputParentEmail:null,$containerCaptcha:null,$imageCaptcha:null,$iconCaptchaReload:null,$buttonSubmit:null,$buttonCancel:null,$errorContainerTemplate:null,$promoVideo:null,$agreedToPrivacyPolicy:null,$agreedToToU:null,$inputSqa:null,$inputSmsCountryCode:null,$inputSmsMobileNumber:null,$inputSmsVerificationCode:null,$sendSmsVerificationButton:null,urlCaptcha:"",goodEmail:!1,goodPassword:!1,matchingPassword:!1,goodAge:!1,goodParentEmail:!1,enterToNextField:!1,skipPrivacyPolicy:!1,agreedToPrivacyPolicy:!1,goodSmsNumber:!1,validatorEmail:null,validatorPassword:null,matchingEmail:!1,formStatus:null,dataLayer:null,captchaReloadTimer:!1,captchaReloadAnimationLength:0,validNumberInputNonCharacterKeyCodes:[8,9,13,27,37,38,39,40,46],smsValidationPattern:null,create:function(){var t=Object.create(this);return t._construct.apply(t,arguments),t},_construct:function(t){t="undefined"==typeof t?{}:t,this.config=$.extend({containerQuery:t.containerQuery||"#form-container",formQuery:t.formQuery||"#account-creation",visibleFormComponentsQuery:t.visibleFormComponentsQuery||"select, input[type='text'], input[type='email'], input[type='password'], input[type='number']",unrestrictedInputFieldsQuery:t.unrestrictedInputFieldsQuery||"input[type='text']",inputParentsQuery:t.inputParentsQuery||".control-group",inputHelpQuery:t.inputHelpQuery||".help-block",selectsRequiredQuery:t.selectsRequiredQuery||"select[required]",inputsRequiredQuery:t.inputsRequiredQuery||"#account-creation [required]",inputNidQuery:t.inputNidQuery||"#nid",inputEmailQuery:t.inputEmailQuery||"#emailAddress",inputEmailConfirmationQuery:t.inputEmailConfirmationQuery||"#emailAddressConfirmation",inputPasswordQuery:t.inputPasswordQuery||"#password",inputPasswordConfirmationQuery:t.inputPasswordConfirmationQuery||"#rePassword",passwordRatingQuery:t.passwordRatingQuery||".password-rating",inputAgeQuery:t.inputAgeQuery||"#age",inputDobDayQuery:t.inputDobDayQuery||"#dobDay",inputDobMonthQuery:t.inputDobMonthQuery||"#dobMonth",inputDobYearQuery:t.inputDobYearQuery||"#dobYear",inputParentEmailQuery:t.inputParentEmailQuery||"#parentContactEmail",containerCaptchaQuery:t.containerCaptchaQuery||".row-captcha",imageCaptchaQuery:t.imageCaptchaQuery||"#security-image",iconCaptchaReloadQuery:t.iconCaptchaReloadQuery||".captcha-reloader",buttonSubmitQuery:t.buttonSubmitQuery||"#account-creation button[type='submit']",buttonCancelQuery:t.buttonCancelQuery||"#creation-cancel-button",errorContainerTemplateQuery:t.errorContainerTemplateQuery||".templates .alert-error",alertContainerQuery:t.alertContainerQuery||".alert",promoVideoQuery:t.promoVideoQuery||".promo-video",passwordGuidelinesQuery:t.passwordGuidelinesQuery||"#wellPasswordGuidelines",agreedToPrivacyPolicyQuery:t.agreedToPrivacyPolicyQuery||"#agreedToPrivacyPolicy",agreedToToUQuery:t.agreedToToUQuery||"#agreedToToU",inputSqaQuery:t.inputSqaQuery||"#question1",inputSmsCountryCodeQuery:t.inputSmsCountryCodeQuery||".phone-country-code",inputSmsMobileNumberQuery:t.inputSmsMobileNumberQuery||"#mobileNumber",inputSmsVerificationCodeQuery:t.inputSmsVerificationCodeQuery||"#smsVerificationCode",sendSmsVerificationButtonQuery:t.sendSmsVerificationButtonQuery||"#send-code-btn",errorClass:t.errorClass||"control-error text-error",loadingClass:t.loadingClass||"loading",urlCaptcha:t.urlCaptcha||"../captcha.jpg",enterToNextField:t.enterToNextField||!1,skipPrivacyPolicy:t.skipPrivacyPolicy||!1,validatorEmail:t.validatorEmail||Email.create(),validatorPassword:t.validatorPassword||null,formStatus:t.formStatus||null,dataLayer:t.dataLayer||null,captchaReloadAnimationLength:t.captchaReloadAnimationLength||500,smsValidationPattern:t.smsValidationPattern||"^[0-9]*$"},t),this.setup()},setup:function(){this.visibleFormComponentsQuery=this.config.visibleFormComponentsQuery,this.inputParentsQuery=this.config.inputParentsQuery,this.inputHelpQuery=this.config.inputHelpQuery,this.iconCaptchaReloadQuery=this.config.iconCaptchaReloadQuery,this.alertContainerQuery=this.config.alertContainerQuery,this.$container=$(this.config.containerQuery),this.$form=$(this.config.formQuery),this.$visibleFormComponents=$(this.config.visibleFormComponentsQuery),this.$unrestrictedInputFields=$(this.config.unrestrictedInputFieldsQuery),this.$selectsRequired=$(this.config.selectsRequiredQuery),this.$inputsRequired=$(this.config.inputsRequiredQuery),this.$inputNid=$(this.config.inputNidQuery),this.$inputEmail=$(this.config.inputEmailQuery),this.$inputEmailConfirmation=$(this.config.inputEmailConfirmationQuery),this.$inputPassword=$(this.config.inputPasswordQuery),this.$inputPasswordConfirmation=$(this.config.inputPasswordConfirmationQuery),this.$passwordRating=$(this.config.passwordRatingQuery),this.$inputAge=$(this.config.inputAgeQuery),this.$inputDobDay=$(this.config.inputDobDayQuery),this.$inputDobMonth=$(this.config.inputDobMonthQuery),this.$inputDobYear=$(this.config.inputDobYearQuery),this.$inputParentEmail=$(this.config.inputParentEmailQuery),this.$containerCaptcha=$(this.config.containerCaptchaQuery),this.$imageCaptcha=$(this.config.imageCaptchaQuery),this.$iconCaptchaReload=$(this.iconCaptchaReloadQuery),this.$buttonSubmit=$(this.config.buttonSubmitQuery),this.$buttonCancel=$(this.config.buttonCancelQuery),this.$errorContainerTemplate=$(this.config.errorContainerTemplateQuery),this.$promoVideo=$(this.config.promoVideoQuery),this.$passwordGuidelines=$(this.config.passwordGuidelinesQuery),this.$agreedToPrivacyPolicy=$(this.config.agreedToPrivacyPolicyQuery),this.$agreedToToU=$(this.config.agreedToToUQuery),this.$inputSqa=$(this.config.inputSqaQuery),this.$inputSmsCountryCode=$(this.config.inputSmsCountryCodeQuery),this.$inputSmsMobileNumber=$(this.config.inputSmsMobileNumberQuery),this.$inputSmsVerificationCode=$(this.config.inputSmsVerificationCodeQuery),this.$sendSmsVerificationButton=$(this.config.sendSmsVerificationButtonQuery),this.errorClass=this.config.errorClass,this.loadingClass=this.config.loadingClass,this.urlCaptcha=this.config.urlCaptcha,this.enterToNextField=this.config.enterToNextField,this.skipPrivacyPolicy=this.config.skipPrivacyPolicy,this.validatorEmail=this.config.validatorEmail,this.validatorPassword=this.config.validatorPassword,this.config.formStatus&&(this.formStatus=this.config.formStatus),this.config.dataLayer&&(this.dataLayer=this.config.dataLayer),this.captchaReloadAnimationLength=this.config.captchaReloadAnimationLength,this.smsValidationPattern=new RegExp(this.config.smsValidationPattern),this.registerEvents(),this.preventOnclickAttributes(),this.setupUserAgentBehaviors(),this.submitActions()},preventOnclickAttributes:function(){$("a[rel=external][onclick]").each(function(){$(this).removeAttr("onclick"),window.phoenix||$(document).on("click","a[rel=external]",function(){$(this).attr("target","_blank")})})},registerEvents:function(){var t=this;$(function(){$(window).on("resize",function(){var e=t.$promoVideo.width(),i=t.$promoVideo.height(),n=t.$promoVideo.parent().width();10>e||(t.$promoVideo.width(n),t.$promoVideo.height(n*(i/e)))}).trigger("resize")}),$(function(){$(".show-password").on("click",function(){var t=$(".show-password i");t.hasClass("icon-eye-open")?(t.removeClass("icon-eye-open"),t.addClass("icon-eye-close"),$("#password").attr("type","text")):(t.removeClass("icon-eye-close"),t.addClass("icon-eye-open"),$("#password").attr("type","password"))})}),this.$form.on("click",".password-guidelines-trigger",function(){$("#password").popover("toggle")}),this.$visibleFormComponents.on("keypress",$.proxy(this.handleEnterKeystroke,this)),this.$unrestrictedInputFields.on("focusout",$.proxy(this.revalidateTextField,this)),this.$form.on("submit",$.proxy(this.validate,this)),this.$inputEmail.on("focusout",$.proxy(this.validateEmail,this,this.$inputEmail,!1)),this.$inputEmailConfirmation.on("focusout",$.proxy(this.compareEmail,this,this.$inputEmailConfirmation,!1)),this.$inputPasswordConfirmation.on("keyup focusout",$.proxy(this.comparePasswords,this)),this.$inputAge.on("input keyup change",$.proxy(this.filterNonNumeric,this)),this.$inputDobDay.on("input keyup change",$.proxy(this.filterNonNumeric,this)),this.$inputDobYear.on("input keyup change",$.proxy(this.filterNonNumeric,this)),this.$inputDobDay.on("focusout",$.proxy(this.validateDobDay,this)),this.$inputDobYear.on("focusout",$.proxy(this.validateDobYear,this)),this.$inputDobMonth.on("change",$.proxy(this.validateDobMonth,this)),this.$inputParentEmail.on("focusout",$.proxy(this.validateEmail,this,this.$inputParentEmail,!0)),this.$agreedToPrivacyPolicy.on("click",$.proxy(this.checkPrivacy,this)),this.$agreedToToU.on("click",$.proxy(this.checkTou,this)),this.$inputSqa.on("change",$.proxy(this.checkSqa,this)),this.$containerCaptcha.on("click",$.proxy(this.refreshCaptcha,this)),this.$inputSmsMobileNumber.on("focusout",$.proxy(this.validateMobileNumber,this,this.$inputSmsMobileNumber,!1)),this.$inputSmsMobileNumber.on("input keyup change",$.proxy(this.filterNonNumeric,this)),this.$inputSmsMobileNumber.on("input keyup change",$.proxy(this.clearField,this,this.$inputSmsVerificationCode)),this.$inputSmsMobileNumber.on("focus",function(){$("#sms-popover").toggle(!0)}),this.$inputSmsMobileNumber.on("focusout",function(){setTimeout(function(){$("#sms-popover").fadeToggle(!1)},150)}),this.$sendSmsVerificationButton.on("click",$.proxy(this.sendCodeValidation,this,this.$sendSmsVerificationButton,this.$inputSmsMobileNumber,this.$inputSmsCountryCode)),this.$inputSmsVerificationCode.on("input keyup change",$.proxy(this.filterNonNumeric,this)),this.$inputSmsVerificationCode.on("focus",function(){$("#code-popover").toggle(!0)}),this.$inputSmsVerificationCode.on("focusout",function(){setTimeout(function(){$("#code-popover").fadeToggle(!1)},150)}),this.$inputNid.on("focus",function(){$("#nid-popover").toggle(!0)}),this.$inputNid.on("focusout",function(){setTimeout(function(){$("#nid-popover").fadeToggle(!1)},150)}),this.formStatus&&this.$buttonCancel.on("click",$.proxy(this.formStatus.toggle,this,!1,this.$buttonCancel[0],!0)),$(".success-content .email > div").fitText()},handleEnterKeystroke:function(t){var e=t.currentTarget;13==t.which&&"select"!=e.tagName&&(this.enterToNextField&&$(e).parents(this.inputParentsQuery).next(this.inputParentsQuery).children(this.visibleFormComponentsQuery).trigger("focus"),t.preventDefault())},revalidateTextField:function(t){var e=t.currentTarget;e.value&&this.toggleErrorState($(e),!0)},getErrorMessage:function(t){t=t.split(".");var e,i,n=messages.errors;for(e=0;e<t.length;e++){if(i=t[e],!i||!n[i])return messages.errors.unknown;n=n[i]}return n},validate:function(){var t=this,e=!1,i=!1,n=[];return this.formStatus&&this.formStatus.toggle(!1,this.$buttonSubmit[0]),this.toggleErrorState(this.$inputsRequired,!0),$.each(this.$inputsRequired,function(i,n){!$.trim(n.value)&&n.id&&(e=!0,t.toggleErrorState($(n),!1))}),e&&(i=!0,n.push(Creation.getErrorMessage("blank"))),this.$inputEmail.length>0&&!this.validateEmail(this.$inputEmail)&&""!=this.$inputEmail.val()&&!this.goodEmail&&(i=!0,this.toggleErrorState(this.$inputEmail,!1,Creation.getErrorMessage("email.message"))),this.$inputEmailConfirmation.length>0&&this.$inputEmailConfirmation.val()!==this.$inputEmail.val()&&(i=!0,this.toggleErrorState(this.$inputEmailConfirmation,!1,Creation.getErrorMessage("emailMatch.message"))),$(".passwordGuidelines .failing").length>0&&(i=!0,this.toggleErrorState(this.$inputPassword,!1,Creation.getErrorMessage("password.message"))),this.$inputPasswordConfirmation.is(":visible")&&!this.matchingPassword&&(i=!0,this.toggleErrorState(this.$inputPasswordConfirmation,!1,Creation.getErrorMessage("rePassword.message"))),this.$inputAge.length&&(this.goodAge=!isNaN(this.$inputAge.val())&&""!==this.$inputAge.val(),this.goodAge||(i=!0,this.toggleErrorState(this.$inputAge,!1,Creation.getErrorMessage("age.message")))),this.$agreedToPrivacyPolicy.prop("checked")||this.skipPrivacyPolicy||(i=!0,this.toggleErrorState(this.$agreedToPrivacyPolicy,!1),this.toggleErrorState(this.$agreedToPrivacyPolicy.parent(),!1)),this.validateEmail(this.$inputParentEmail)||!this.$inputParentEmail.length||""==this.$inputParentEmail.val()||this.goodParentEmail||(i=!0,this.toggleErrorState(this.$inputParentEmail,!1,Creation.getErrorMessage("email.message"))),!this.$inputDobYear.length||this.validateDobYear()&&this.validateDobMonth()&&this.validateDobDay()||(i=!0),i?(this.formStatus&&this.formStatus.toggle(!0),$("form #creation-submit-button").button("reset"),this.showAlert(n),!1):!0},validateEmail:function(t,e){var i,n,o="";e?(this.goodParentEmail=this.validatorEmail.check(t.val()),i=this.goodParentEmail):(this.goodEmail=this.validatorEmail.check(t.val()),i=this.goodEmail),n=i||!t.val()&&!this.hasError(t),t.val()&&(o=Creation.getErrorMessage("email.message")),this.toggleErrorState(t,n,o)},compareEmail:function(t){var e=this.$inputEmail.val(),i=this.$inputEmailConfirmation.val();"focusout"==t.type&&(e=e.substring(0,i.length)),this.matchingEmail=e==i,this.toggleErrorState(this.$inputEmailConfirmation,i&&this.matchingEmail,Creation.getErrorMessage("emailMatch.message"))},comparePasswords:function(t){var e=this.$inputPassword.val(),i=this.$inputPasswordConfirmation.val();"keyup"==t.type&&(e=e.substring(0,i.length)),this.matchingPassword=e==i,this.toggleErrorState(this.$inputPasswordConfirmation,i&&this.matchingPassword,Creation.getErrorMessage("rePassword.message"))},validateDobYear:function(){var t=!0;if(this.$inputDobYear.length){var e=this.$inputDobYear.val();t=""!=e&&4==e.length&&!isNaN(e)&&e>=1899}return this.toggleErrorState(this.$inputDobYear,t),t},validateDobMonth:function(){var t=!0;if(this.$inputDobMonth.length){var e=this.$inputDobMonth.val();t=""!=e&&!isNaN(e)}return this.toggleErrorState(this.$inputDobMonth,t),t},validateDobDay:function(){var t=!0;if(this.$inputDobDay.length){var e=this.$inputDobDay.val();t=""!=e&&(1==e.length||2==e.length)&&!isNaN(e)&&e>=1&&31>=e}return this.toggleErrorState(this.$inputDobDay,t),t},filterNonNumeric:function(t){var e=$(t.target);e.val(e.val().replace(/[^0-9]/g,"")),this.$inputAge.val()&&this.toggleErrorState(this.$inputAge,!0)},checkPrivacy:function(t){this.$agreedToPrivacyPolicy.prop("checked")&&!this.skipPrivacyPolicy&&this.toggleErrorState(this.$agreedToPrivacyPolicy,!0)},checkTou:function(t){this.$agreedToToU.prop("checked")&&this.toggleErrorState(this.$agreedToToU,!0)},checkSqa:function(t){this.$inputSqa.val&&this.toggleErrorState($("#select-box-question1"),!0)},refreshCaptcha:function(){var t=this;this.$imageCaptcha.attr("src",this.urlCaptcha+"?"+(new Date).getTime()),this.$iconCaptchaReload.addClass(this.loadingClass),this.captchaReloadTimer=setTimeout(function(){$(t.iconCaptchaReloadQuery).removeClass(t.loadingClass)},this.captchaReloadAnimationLength)},toggleErrorState:function(t,e,i){i=i||"";var n=t.parents(this.inputParentsQuery),o=t.siblings(this.inputHelpQuery);e?(n.removeClass(this.errorClass),o.html("")):(n.addClass(this.errorClass),i?(o.html('<i class="icon-remove icon-red"></i>'+i),this.dataLayer&&this.dataLayer.push({event:"gtm.message","error-inline":t.attr("id")})):o.html(""))},showAlert:function(t){t=t||[];var e=this.$errorContainerTemplate.clone(),i="",n=this;t.length&&($.each(t,function(t,e){i+="<li>"+e.message+"</li>",n.dataLayer&&n.dataLayer.push({event:"gtm.message","error-box":e.code})}),i="<ul>"+i+"</ul>"),i=Creation.getErrorMessage("header.message")+i,this.$container.find(this.alertContainerQuery).remove(),e.append(i),this.$container.prepend(e),window.scrollTo(0,0)},hasError:function(t){return t.parents(this.inputParentsQuery).hasClass(this.errorClass)},setLoginCsrfToken:function(t){$(".account-creation-oauth-form input[name='csrftoken'][value='-']").val(t),$(".account-creation-oauth-form button").prop("disabled",!1)},requestLoginCsrfToken:function(t){var e=this;$.ajax({url:t,xhrFields:{withCredentials:!0},success:function(t){"string"!=$.type(t)?e.setLoginCsrfToken(t.getElementById("csrftoken").value):(html=$("div",t),e.setLoginCsrfToken(html.find("#csrftoken").value))},error:function(){e.setLoginCsrfToken("-")}})},setupUserAgentBehaviors:function(){/(iPhone|iPad|iPod|Android)/gi.test(navigator.userAgent)||($("#age").attr("type","text"),$("#dobDay").attr("type","text"),$("#dobYear").attr("type","text"),window.phoenix||$(".first input").first().focus())},submitActions:function(){$("form").on("click",'.btn[type="submit"]:not([rel="external"])',function(t){$(t.target).button("loading")})},validateMobileNumber:function(t){var e,i,n="";this.goodSmsNumber=this.smsValidationPattern.test(t.val()),e=this.goodSmsNumber,i=e||!t.val()&&!this.hasError(t),t.val()&&(n=Creation.getErrorMessage("sms.message")),this.toggleErrorState(t,i,n)},startTimer:function(t,e){e.prop("disabled",!0);var i=e.text();e.text("");var n,o,r=t,s=setInterval(function(){sessionStorage.timeout=r,n=parseInt(r/60,10),o=parseInt(r%60,10),0===n?e.text(o):(o=10>o?"0"+o:o,e.text(n+":"+o)),--r<0&&(e.prop("disabled",!1),e.removeClass("disabled"),e.text(i),clearInterval(s),delete sessionStorage.timeout)},1e3)},sendCodeValidation:function(t,e,i){if(!e.val())return void this.toggleErrorState(e,!1,Creation.getErrorMessage("sms.message"));var n=i.find(":selected").val();if(!n)return void this.toggleErrorState(i,!1,Creation.getErrorMessage("sms.message"));if(this.validateMobileNumber(e),this.goodSmsNumber){var o=this.$form.find("#csrftoken").val(),r={url:"../sms-verification/send-code",type:"POST",data:{csrftoken:o,mobileNumber:e.val(),countryCode:n},beforeSend:function(){t.button("loading"),$("#resent-alert").hide()},success:function(e){t.removeClass("loading"),Creation.startTimer(e.timeout,t),$("#cleansedMobileNumber").val(e.cleansedNumber),$("#phoneCountryCode").val(n)},error:function(i){t.removeClass("loading");var n=i.responseJSON.timeout,o=i.responseJSON.message;switch(i.status){case 429:Creation.startTimer(n,t),$("#resend-alert").fadeIn();break;case 400:if("serverError.message"===o)Creation.startTimer(n,t);else{if("throttled"===o){$("#resend-alert").fadeIn(),Creation.startTimer(n,t);break}t.prop("disabled",!1),t.removeClass("disabled")}Creation.toggleErrorState(e,!1,Creation.getErrorMessage(o));break;default:Creation.startTimer(n,t),Creation.toggleErrorState(e,!1,Creation.getErrorMessage("serverError.message"))}}};$.ajax(r)}},clearField:function(t){t.val("")}};!function(t){t.fn.fitText=function(e,i){var n=e||1,o=t.extend({minFontSize:Number.NEGATIVE_INFINITY,maxFontSize:Number.POSITIVE_INFINITY},i);return this.each(function(){var e=t(this),i=function(){e.css("font-size",Math.max(Math.min(e.width()/(10*n),parseFloat(o.maxFontSize)),parseFloat(o.minFontSize)))};i(),t(window).on("resize.fittext orientationchange.fittext",i)})},sessionStorage.timeout&&!isNaN(sessionStorage.timeout)&&Creation.startTimer(sessionStorage.timeout,t("#send-code-btn"))}(jQuery);var BattleTag={$modal:"",$inputBattleTag:"",$buttonSubmit:"",$errors:"",$buttonChangeBattleTag:"",$labelBattleTag:"",$labelBattleTagNumber:"",$questions:"",urlEndpoint:"../../management/battletag/create",init:function(){BattleTag.$modal=$("#modal-battletag"),BattleTag.$inputBattleTag=$("input[name=battleTag]"),BattleTag.$buttonSubmit=$("#modal-battletag button[type=submit]"),BattleTag.$errors=$("#modal-battletag .errors"),BattleTag.$buttonChangeBattleTag=$("[data-target=#modal-battletag]"),BattleTag.$labelBattleTag=$(".battletag .success-accountName .battleTagName"),BattleTag.$labelBattleTagNumber=$(".battletag .success-accountName .battleTagNumber"),BattleTag.$questions=$(".battletag h6"),BattleTag.bindEvents()},bindEvents:function(){BattleTag.$buttonSubmit.on("click",function(t){return BattleTag.submit()}),BattleTag.$questions.on("click",function(t){$(this).next("p").toggleClass("open")})},submit:function(){BattleTag.attemptBattleTagChange(this.$inputBattleTag.val())},attemptBattleTagChange:function(t){$.post(BattleTag.urlEndpoint,{battleTag:BattleTag.$inputBattleTag.val()},BattleTag.handleResponse,"json")},handleResponse:function(t){if(BattleTag.$errors.empty(),t.success)BattleTag.$modal.modal("hide"),BattleTag.$labelBattleTag.text(t.battleTagName),BattleTag.$labelBattleTagNumber.text(t.battleTagNumber),BattleTag.$buttonChangeBattleTag.remove();else for(var e in t.errorMessages)BattleTag.$errors.append('<li class="text-error"><i class="icon icon-alert icon-red"></i>'+t.errorMessages[e]+"</li>")}};$(BattleTag.init());